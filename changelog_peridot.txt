Device name: Poco F6/ Redmi Turbo 3
Device codename: peridot
Device maintainer: kenway214


## DerpFest 15

**Device Changelog 13.04.2025**

- Latest source changes
- March security patch (QPR1) ,HyperOS 2 based
- Switch to common xiaomi vibrator service
- Adapt to xiaomi vibrator effects
- Import init.peridot.rc
- Import auto-brightness configs from houji
- PowerTools: Bump version to v3.0
- PowerTools- Full codebase refactor for the PowerTools module
- PowerTools- Added 'Unknown' mode: if any external module modifies PowerTools behavior unexpectedly, the mode will automatically switch to 'Unknown' to reflect the change
- Game Bar v4.0 – Complete rework of the entire codebase for better performance and maintainability.
      Added two FPS tracking methods:

      1. Modern Android API-based method
      2. Legacy system-based method (for broader compatibility)

      Improved draggable overlay:

      - Overlay can now be moved freely (bugfix) and placed anywhere on the screen (select customisaton/ovrlay position/custom draggable)

      Auto-launch Game Bar for selected apps:

      - Game Bar can now automatically launch when a selected app is opened
      - Add apps from the bottom section of the Game Bar menu
      - Toggle the Auto Enable switch to allow launch even when the main Game Bar toggle is off

- Refactored SELinux policies, removed neverallow workarounds
- parts: Bumped minSdkVersion to 33 and targetSdkVersion to 35 to support modern APIs.
- Updated privapp whitelist to grant necessary permissions for new features
- Fixed dolby.media.c2@1.0-service crashing
- Fixed HDR cintent detection in OTT platorms
- Updated gameproputils spoofing devices

**Device Changelog 31.3.2025**

- Latest source changes
- March security patch (QPR1) ,HyperOS 2 based
- Introduce Power tools v1.0 (Customize power profiles, limit CPU/GPU frequencies, and change governor settings without root) (settings/battery)
- Fixed display stuck at 30hz after unlocking device occasionally when 120hz adaptive mode is selected (fixup hos2)
- Fixed USSD code via dialer (fixup hos2)
- Generate qcrilNr.db during build
- qcril-database: Add host tool to generate qcrilNr.db from migrations
- qcril_database: Add migration to disable redir_party_num (fixup)
- qcril_database: Add migration to turn off persist.vendor.radio.poweron_opt (fixup)
- Build FastCharge from yaap , Dropped lineage fastcharge (fixed fastcharging issues)
- Import missing hos2 blobs (fixup: update blobs from miui_PERIDOTINGlobal_OS2.0.100.0.VNPMIXM)
- Resolve missing symbols on codec2 blobs using shim
- fwb: notify HWUI when scrolling
- services/core: Add interaction launch boosts
- services: Implement activity boost optimization
- Add support of CameraX Vendor Extensions


**Device Changelog 23.3.2025**

- Latest source changes
- March security patch (QPR1) ,HyperOS 2 based
- Fixed Leica crash issue on hyper os2 based aosp roms (front and video 4k 60 fps works fine now)
- Fixed Apps getting killed as soon as they went backgrund/minimised
- Properly disable phantom process killing
- Tune sf region sampling
- Tune adaptive suspend proprieties
- Resolve missing symbols on libwrapper_dlengine
- Build some required camera packages
- Migrate mount point symlink creation to blueprint
- Enable xiaomi vibrator effects on common QTI vibrator hal
- Update vibrator firmware paths for proper mapping
- Drop unused vibrator effects
- Declare some libs as symlinks during extraction
- Disable skia tracing
- Enable ro.config.avoid_gfx_accel
- Set renderengine backend to skiavk
- Disable gl backpressure
- overlay: add more list to pinned service
- Reduce system server verbosity
- Tone down CamX and CHIUSECASE logging
- overlay: Set keyguard refresh rate to 120
- Add some props for better RAM management
- Silence some spammy logging
- sepolicy: Address some sepolicy denials


**Device Changelog 21.3.2025**

- Latest source changes
- March security patch (QPR1)
- Based on  miui_PERIDOTINGlobal_OS2.0.100.0.VNPMIXM
- stock kernel from miui_PERIDOTINGlobal_OS2.0.100.0.VNPMIXM
- Implement torch light control (via QS Flashlight Tile)
- Fixed Charging Control


**Device Changelog 17.3.2025**

- Latest source changes
- March security patch (QPR1)
- Updated vendor blobs from V816.0.12.0.UNPMIXM
- Switched to stock kernel
- Updated prebuilt modules from V816.0.12.0.UNPMIXM
- Introduce GameBar v2.0 (Settings/Apps)
- Introduce Power profiles (Settings/Battery) and powerprofile QS tile (4 Modes - Balance // Gameboost // High Performance // Powersave )
- Auto-enable support for High Touch Pooling Rate for games added in gamespace app.(enable toggle from settings/display/HTPR settings page)
- Add video demonstration for High Touch Polling Rate feature
- Add auto-enable High Touch Polling Rate in Game Mode (enable toggle from settings/display/HTPR settings page)
- Fixed display stuck at 30hz after unlocking device occasionally when 120hz adaptive mode is selected
- Fixed USSD code via dialer (no sim restart script)
- Add migration to turn off persist.vendor.radio.poweron_opt
- Enable support for kernel idle timer
- rootdir: Configure schedutil ratelimits
- rootdir: Configure cpusets for audio-app and system-background
- Enable TWS plus feature using persist property
- Enable Qualcomm TrueWireless™ Stereo
- AAC frame control enabled for hal implementation
- Add support for low power adaptive control feature
- Disable BT A2DP AAC whitelist
- Updated gameproputils spoofing devices (can play BGMI/PUBG at 120 fps)


**Device Changelog 02.2.2025**

- Latest source changes
- Improved Game Space (Hotfix - can add games now)


**Device Changelog 01.2.2025**

- Latest source changes
- Introduce one-shot HBM via Quick Settings tile (QS tile will be unavailable if Automatic HBM service is enabled)
- Fixed Automatic High Brightness Mode (HBM) not working properly after device restart (Note: 5-second delay added after restart)
- In QS, there are now two separate QS tiles: "Auto HBM" and "HBM"
- Enabled proper notifications when each QS tile is activated
- Introduced long press on QS tiles (Touch Boost tile, HBM tile, Thermal Profile, and Refresh Rate tile) to open the main settings page
- ThermalTileService: Introduced Process Priority and Memory Trimming Level for better performance (Performance Mode Thermal) and better battery life (Battery Saver Thermal)
- Fixed incoming call number duplication
- Reverted fix for the top speaker to prevent buzzing sound from the top speaker on the lock screen and during calls
- Dropped HyperOS Gallery, Gallery Editor, HyperOS Bokeh, and MIUI Video Player
- Fixed Leica not opening in the lock screen widget
- Fixed double-clicking the power button while on the lock screen to open the Leica camera
- Added Quick Tap
- Improved Game Space
- Updated gameproputils spoofing devices


**Device Changelog 26.1.2025**

- Latest source changes
- Introduce High Brightness Mode (HBM)
- Reverted USSD fix -maybe causing no sim signal (hotfix)
- ThermalTileService: Automatically switched to battery thermal profile when system battery saver mode on
- ThermalTileService: Disable cpu lpm in performance mode
- ThermalTileService: Enable notification for performence mode
- Introduce DSPVolumeSynchronizer - prevent speaker distortion at high volume
- audio: Fix mic issues in apps like WhatsApp
- Fixup High Touch Sampling Rate (HTSR) service logic
- Add RefreshRate QS tile


**Device Changelog 18.1.2025**

- Latest source changes
- Import missing audio vendor and odm props
- Set default Wi-Fi country code to '00'
- rootdir: Move background cpuset to CPU0-1
- rootdir: Set restricted cpuset to the same CPUs as system-background
- parts: Reset touch sampling rate on service destruction and Refactor code
- Fixed whatsapp videocall issues
- Fixed snapchat camera lenses not working
- Fixed leica camera occasional crash in specific cases.
- Updated gameproputils spoofing devices


**Device Changelog 10.1.2025**

- Latest source changes
- QPR1 with December security patch
- Combined Per-App Thermal Profile (Settings > Battery) and Thermal Profile Tile Service (Quick Settings) for seamless integration.

        Per-App Thermal Profile (Settings > Battery)
  • Added a Master Switch for Per-App Thermal Profile.
  • Automatically determine thermal profiles for apps.
  • Updated drawables for a modern look.
  • Updated sconfig values to match the stock ROM for better compatibility.
  • Master Switch is disabled by default on the initial reboot. 
  • Enable it if you prefer Per-App Thermal Profile over Thermal Profile Tile Service.
  • When Per-App Thermal Profile is enabled (Via master switch):Thermal Profile Tile Service is automatically disabled.
     Thermal profiles are applied on a per-app basis.
  • When the Master Switch is disabled (Via master switch):System-wide Thermal Profile Tile Service is automatically enabled.

        Thermal Profile Tile Service (Available via Quick Settings)
  • Reworked the Thermal Profile Tile Service for a more universal, system-wide implementation.
  • Dropped Game Mode thermal profile.
  • Now includes only three modes: Default //Performance //Battery Saver
  • Battery Thermal Profile:Automatically enables system-wide Battery Saver mode when set.

- Improvement in auto brightness specially in dark environment 
- Fixed flickering in very low brightness when auto brightness is enabled in dark    environment.
- Switched back to Realking V4 kernel (ksu)
- Fixed USSD code via dialer
- Fixup High Touch Sampling Rate (HTSR) service logic
- Switch back to stock vibratorfeature
- Fixed top speaker during alarm not working
- Fixed top speaker in lock screen


**Device Changelog 22.12.2024**

- Latest source changes
- Fixed PowerOffAlarm service
- DerpLauncher: Added circle to search
- Fixed crashing MIUI Camera when trying to play recorded videos directly from the Camera app
- Imported missing ADSP blobs
- Built libaudioroute for vendor
- Dropped some prebuilt GMS packages
- Updated HyperOS Gallery and GalleryEditor
- efactored thermal profile tile and touch boost tile
- Updated REAL-KING Kernel to v5


**Device Changelog 13.12.2024**

- December security patch
- Latest source Changes
- WifiDisplay: Fixed Wifi Display DRM
- Updated blobs from V816.0.10.0.UNPMIXM
- MiuiCamera: Update to leica camera from aurora
- MiuiCamera: Fixed raw image taking in pro mode
- Fixed status bar padding
- Fixed lock scrren widget
- Improvement in autobrightness responsiveness
- Fix crash when camera IDs list is null
- Camera: Fix camera id equal check
- Camera: Prevent crash when unable to find tag
- StreamConfigurationMap: add constructor for MIUI camera
- Add backwards-compatible CaptureResultExtras constructor
- Camera: Don't throw exceptions when value pairs have spaces in them
- Add config overlay to force enable multi resolution for camera
- Camera: Extend face detection
- Fix Photosphere/Camera FCs
- libcameraservice: Add support to set vendor tag with client package name
- cameraserver: Allow google camera to access multiple cameras
- cameraserver: Let multiple cameras opened by stock camera application
- CAMX: CHI: Added support for handling jpeg debug data.
- camera: Expose aux cameras in third party apps
- libstagefright: Allow HFR-60 in HAL-3 recording
- stagefright: add changes related to high-framerates in CameraSource
- audio: add encoding support for linear PCM format
- media: Add timelapse 4k UHD Camcorder profile to quality map
- av: support for 24bit encoding and 6 channels
- Nuplayer: Avoid crash when codec fails to load
- Nuplayer: Declare 24Bit Packed & 32Bit support
- av: Audio Policy: Increase Max Sample Rate Hz to 384k
- Fixed Lineage Health HAL
- DolbyManager: Make bass enhancer available on speakers as well
- DolbyManager: Migrate MainSwitchBar and Switch to Material3
- Import prebuilt libtinycompress blob
- Add a property to enable prefetching video
- Updated BCR to 1.74

**Device Changelog 07.12.2024**

- Fixed Miui camera and Gcam 4k 60fps video recording
- Fixed Auto brightness on AOD
- Fixed fod not responding in AOD after sometimes when phone in aod state
- Added support for 120 fps in certain games
- Fixed secure NFC functionality
- sepolicy: Label ro.hardware.chipname property
- sepolicy: Address some mediacodec sepolicy denials
- parts: Rebrand to com.xiaomi.settings
- Refractor double tap to wake

**Device Changelog 30.11.2024**

- Latest source Changes
- Fixed High Touch Sampling Rate (HTSR) getting reset after reboot
- Improved logic for touch responsiveness tile . Tile renamed to Touch boost
- Fixed AOD colors . set to default
- Fixed Display features color service
- Fixed some sepolices
- Improved logic Thermal profile tile logic
- Add permissions and whitelist for Xiaomi parts
- Refactor BootCompletedReceiver
- CameraManager: Fix NPE in getting cameraIds
- FlashlightControllerImpl: Fix crash when camera IDs list is null

**Device Changelog 24.11.2024**

- Latest source Changes
- parts: Introduce High Touch Sampling Rate (Settings/Display/Touch Responsiveness)
- Introduce Touch Responsivenes tile in quicksettings 
- Fixed double tap to ambient instead of fully waking
- Fixed volte/vonr/calling (hotfix)
- init: Optimize cpuset configuration for improved performance
- rootdir: Remove `wait_for_keymaster` and all references
- audio: s/libmisoundfx/libmisoundfx_ext
- Enable QS media player turbulence effect
- Import QCOM audio effects from OnePlus 9R
- audio: use QCOM Implementation for Audio Effects

**Device Changelog 17.11.2024**

- Nov security patch.
- Latest source Changes
- Fixed UDFPS animations causing issues with fod.
- biometrics: Fix udfps races
- Import missing AtFwd2 app
- parts: Set standard display color mode in AOD and  
- parts: Refactored colorservices code
- Update PRODUCT_BUILD_PROP_OVERRIDES with normalized variables
- Add missing xiaomi ecc list to vendor
- update REAL-KING Kernel v4 (NON KSU version)

**Device Changelog 10.11.2024**

- Latest source Changes.
- props: Set ro.mediaserver.64b.enable true
- props: Define ro.media.recorder-max-base-layer-fps
- props : Import some media system props
- Setup runtime cpusets
- Chown the cgroup.procs nodes
- Disable multiple kswapd threads
- Lower down rate limit for prime CPU
- Import cgroup tuning from gs101
- Enable uclamp latency_sensitive for top-app
- adjust thread count and cpuset after setup wizard
- Configure schedutil up/down rate limit
- Manually place msm_drm and msm_kgsl_3d0 IRQs
- sepolicy: Label persist.vendor.aiie_capture_log.debug
- overlay: Update pixel pitch
- udfps: Mimic stock logic
- SystemUI: UdfpsView: minor code improvement
- UdfpsView/AuthController: cleanup old merge conflict res
- Reduce padding on the UDFPS foreground icon
- update miuicamera from V816.0.9.0.UNPMIXM
- update REAL-KING Kernel v4 (KSU version)

**Device Changelog 03.11.2024**

- Latest source Changes.
- Fixed potrait mode in miui camera.
- Sepolicy: Add camera perf and postproc hwservice sepolicies
- Update from V816.0.9.0.UNPMIXM
- Added miui bokeh in MIUI Gallery
- Droped wfdhdcp DRM policy
- Import missing perf blobs
- Drop useless graphic blobs
- Import missing librendercore.so
- Import missing QESDK blobs
- Sync extract scripts with 22 templates
- overlay: Enable multiple vibration strength levels
- overlay: Set keyguard refresh rate to 120
- overlay: Improve status bar padding
- properties: Use HintManager for HWUI
- Import more Video Calls related props
- Force enabling IMS capabilities fixes volte vonr vowifi


**Device Changelog 26.10.2024**

- Latest source Changes.
- OTA enabled. Now you can directly update from inbuilt updater app.(settings/system/derpfest updater)
- Switched to REAL-KING Kernel v3 (KSU version)
- Fixed Google recorder voice to speech recognision.
- Switch to armv8-2a-dotprod arch variant. It's better than armv9-a because of SVE2 and performance in sm8650.
- Import Wifi Display.
- Implement Pocket Detection service
- Use NonUI sensor for pocket mode
- Link dolby blobs against v33 libstagefright_foundation. fixes crashes and absurdly high CPU usage while using dolby.
- Import Device features.
- Expose aux cameras to com.android.camera and Aperture.
- Import libhidltransport
- Build Camera Legacy HIDL deps
- ship device specific uuid's
- overlay: Adjust keyguard_indication_margin_bottom
- Build libusbhost.vendor
- Patch libwfdservice to resolve duplicate dependencies
- Allow gettid syscall for wfdhdcphalservice
- Shim WFD with libgui_shim/libinput_shim


**Device Changelog 20.10.2024**


- Oct security patch and latest Derpfest 15 Source Changes.
- Introduce Thermal Profile Tile Service ( Default/Battery saving/Gaming/Performance mode) -add it in quicksettings panel.
- Removed Per app thermal profile.
- Fixed Pocket Mode.
- Added Face Unlock.
- Updated BCR to 1.72
- Switched to stock kernel. (No KSU included )
- Fixed scrooling lag in certain apps ( i.e chrome ,youtube, netflix etc) Now its correctly at 120 fps .( maps still 60 tell google to fix that).
- Disable redir_party_num. fixes incoming caller number not being parsed correctly by Phone app on VoLTE and VoWiFi.
- Disabled the SRE Display Feature.
- Disabled the Frame Rate Override Feature.
- Added sensors.xiaomi.v2.
- Updated Thermal Profiles .
- Update Display Saturation Service Drawable .
- Added missing camera properties.
- Updated SEPolicy for missing file contexts and permissions.
- Built SensorService 1.0.
- Included libziparchive.



**Device Changelog 13.10.2024**

- Adjust auto brightness configuration
- Introduce displayfeature color service
- Import HyperOS Gallery ,Gallery AI Editor
- Fixed HyperOS Cam low resolution photos. Now it can take full resolution images
- Fixed HyperOS Cam OIS
- Fixed Speaker volume not controlled by vol buttons
- Improved speak volume
- Import thermal engine and thermal service
- Fixed Smooth Display
- Enable and adjust ambient display burn-in protection
- Fixed Netflix DRM in android 15
- Fix microphone issues in certain apps (e.g., WhatsApp)
- Remove BT LC3 codec support
- Add A2DP Bluetooth audio routes
- Disable Dynamic Range Compression in audio
- Set 5G icon always available
- Improve carrier MNC attributes for better compatibility
- Enable VoNR support
- Force-enable IMS capabilities
- Switch to Xiaomi healthd-ext HAL (AIDL)
- Address SEPolicy issues
- Switched to REAL-KING Kernel v3 (KSU version)



**Device Changelog 06.10.2024**

- Fixed double tap to wake
- Fixed UDFPS icon glitching
- Fixed UDFPS in AOD
- Fixed USB otg not working
- Fixed vonr not working for some
- Fixed device certified and play integrity , not strong . Please Read Carefully
- Included memecam , Dolby Atmos, Dolby Vision
- Included per app refresh rate , Per app thermal Profiles via xiaomi parts
- spatial audio
- Included custom display saturation slider

**Device Changelog 04.10.2024**

- Initial A15 build

 Knows Issues:
• Screen off udfps not working
• Visual glitch on udfps when unlocking but its working fine
• meme cam back camera portrait mode dead
• Device uncertified (use certified props) (source sided)
• No face unlock yet (source sided)
• No customization yet (source sided)